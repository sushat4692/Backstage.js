/*!
  backstage.js v0.0.3
  https://github.com/sushat4692/backstage.js#readme
  Released under the MIT License.
*/
var Backstage=function(){"use strict";var e=function(){var e=new Set;return{on:function(t){e.add(t)},off:function(t){e.delete(t)},offAll:function(){e.clear()},emit:function(t){e.forEach((function(e){return e(t)}))}}},t=function(){var t=e(),o=e(),r=e(),n=e(),f=e();return{progress:t,error:o,complete:r,fileProgress:n,fileComplete:f,on:function(e){var l=e.type,i=e.emitter;switch(l){case"progress":t.on(i);break;case"error":o.on(i);break;case"complete":r.on(i);break;case"file_progress":n.on(i);break;case"file_complete":f.on(i)}},off:function(e){var l=e.type,i=e.emitter;switch(l){case"progress":t.off(i);break;case"error":o.off(i);break;case"complete":r.off(i);break;case"file_progress":n.off(i);break;case"file_complete":f.off(i)}},offAll:function(e){switch(e){case"progress":t.offAll();break;case"error":o.offAll();break;case"complete":r.offAll();break;case"file_progress":n.offAll();break;case"file_complete":f.offAll()}}}},o=function(e){var o=0,r=0,n=null,f=t(),l=f.progress,i=f.error,a=f.complete,c=f.on,s=f.off,u=f.offAll,p=function(){n&&(n.abort(),n=null)};return{on:c,off:s,offAll:u,start:function(){(n=new XMLHttpRequest).open("get",e,!0),n.responseType="blob",n.onloadstart=function(e){console.log(e),r=e.loaded,e.lengthComputable&&(o=e.total),l.emit({total:o,current:r,per:r/o})},n.onprogress=function(e){console.log(e),r=e.loaded,e.lengthComputable&&(o=e.total),l.emit({total:o,current:r,per:r/o})},n.onload=function(t){a.emit({total:o,file:{file:e,size:o}}),p()},n.onerror=function(t){i.emit(new Error("Failed to load ".concat(e))),p()},n.send()},abort:p}},r=function(){return r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},r.apply(this,arguments)},n=function(e,n){switch(e){case"parallel":return function(e){var r=e.length,n=0,f=t(),l=f.progress,i=f.error,a=f.complete,c=f.fileComplete,s=f.on,u=f.off,p=f.offAll,m=[],g=[];return e.forEach((function(e){var t=o(e);t.on({type:"progress",emitter:function(e){l.emit({total:r,current:n,per:n/r})}}),t.on({type:"complete",emitter:function(e){n+=1,g.push(e.file),c.emit({total:r,file:e.file}),n>=r&&a.emit({total:r,files:g})}}),t.on({type:"error",emitter:function(e){return i.emit(e)}}),m.push(t)})),{on:s,off:u,offAll:p,start:function(){m.forEach((function(e){return e.start()}))}}}(n);case"serial":return function(e){var n=e.length,f=0,l=0,i=t(),a=i.progress,c=i.error,s=i.complete,u=i.fileProgress,p=i.fileComplete,m=i.on,g=i.off,b=i.offAll,h=[],d=[];return e.forEach((function(e){var t=o(e);t.on({type:"progress",emitter:function(t){u.emit(r(r({},t),{file:e})),a.emit({total:n,current:f,per:f/n})}}),t.on({type:"complete",emitter:function(e){f+=1,d.push(e.file),p.emit({total:n,file:e.file}),f>=n?s.emit({total:n,files:d}):h[l+=1].start()}}),t.on({type:"error",emitter:function(e){return c.emit(e)}}),h.push(t)})),{on:m,off:g,offAll:b,start:function(){h[l].start()}}}(n);default:return e}};return function(e,t){return n(e,t)}}();
