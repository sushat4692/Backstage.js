/*!
  backstage.js v0.0.3
  https://github.com/sushat4692/backstage.js#readme
  Released under the MIT License.
*/
import { eventmit } from 'eventmit';

var useLoaderEmitter = function () {
    var progress = eventmit();
    var error = eventmit();
    var complete = eventmit();
    var fileProgress = eventmit();
    var fileComplete = eventmit();
    var on = function (_a) {
        var type = _a.type, emitter = _a.emitter;
        switch (type) {
            case "progress":
                progress.on(emitter);
                break;
            case "error":
                error.on(emitter);
                break;
            case "complete":
                complete.on(emitter);
                break;
            case "file_progress":
                fileProgress.on(emitter);
                break;
            case "file_complete":
                fileComplete.on(emitter);
                break;
        }
    };
    var off = function (_a) {
        var type = _a.type, emitter = _a.emitter;
        switch (type) {
            case "progress":
                progress.off(emitter);
                break;
            case "error":
                error.off(emitter);
                break;
            case "complete":
                complete.off(emitter);
                break;
            case "file_progress":
                fileProgress.off(emitter);
                break;
            case "file_complete":
                fileComplete.off(emitter);
                break;
        }
    };
    var offAll = function (key) {
        switch (key) {
            case "progress":
                progress.offAll();
                break;
            case "error":
                error.offAll();
                break;
            case "complete":
                complete.offAll();
                break;
            case "file_progress":
                fileProgress.offAll();
                break;
            case "file_complete":
                fileComplete.offAll();
                break;
        }
    };
    return {
        progress: progress,
        error: error,
        complete: complete,
        fileProgress: fileProgress,
        fileComplete: fileComplete,
        on: on,
        off: off,
        offAll: offAll,
    };
};

var FileLoader = function (file) {
    var total = 0;
    var current = 0;
    var xhr = null;
    // Event Emitter
    var _a = useLoaderEmitter(), progress = _a.progress, error = _a.error, complete = _a.complete, on = _a.on, off = _a.off, offAll = _a.offAll;
    var start = function () {
        xhr = new XMLHttpRequest();
        xhr.open("get", file, true);
        xhr.responseType = "blob";
        xhr.onloadstart = function (e) {
            current = e.loaded;
            if (e.lengthComputable) {
                total = e.total;
            }
            progress.emit({ total: total, current: current, per: current / total });
        };
        xhr.onprogress = function (e) {
            current = e.loaded;
            if (e.lengthComputable) {
                total = e.total;
            }
            progress.emit({ total: total, current: current, per: current / total });
        };
        xhr.onload = function (e) {
            complete.emit({ total: total, file: { file: file, size: total } });
            abort();
        };
        xhr.onerror = function (e) {
            error.emit(new Error("Failed to load ".concat(file)));
            abort();
        };
        xhr.send();
    };
    var abort = function () {
        if (!xhr) {
            return;
        }
        xhr.abort();
        xhr = null;
    };
    return {
        on: on,
        off: off,
        offAll: offAll,
        start: start,
        abort: abort,
    };
};

var ParallelLoader = function (files) {
    var fileLength = files.length;
    var loadedFileLength = 0;
    // Event Emitter
    var _a = useLoaderEmitter(), progress = _a.progress, error = _a.error, complete = _a.complete, fileComplete = _a.fileComplete, on = _a.on, off = _a.off, offAll = _a.offAll;
    var loaders = [];
    var fileResults = [];
    files.forEach(function (file) {
        var loader = FileLoader(file);
        loader.on({
            type: "progress",
            emitter: function (_) {
                progress.emit({
                    total: fileLength,
                    current: loadedFileLength,
                    per: loadedFileLength / fileLength,
                });
            },
        });
        loader.on({
            type: "complete",
            emitter: function (e) {
                loadedFileLength += 1;
                fileResults.push(e.file);
                fileComplete.emit({
                    total: fileLength,
                    file: e.file,
                });
                if (loadedFileLength >= fileLength) {
                    complete.emit({
                        total: fileLength,
                        files: fileResults,
                    });
                }
            },
        });
        loader.on({
            type: "error",
            emitter: function (e) { return error.emit(e); },
        });
        loaders.push(loader);
    });
    return {
        on: on,
        off: off,
        offAll: offAll,
        start: function () {
            loaders.forEach(function (loader) { return loader.start(); });
        },
    };
};

var _assign = function __assign() {
  _assign = Object.assign || function __assign(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }
    return t;
  };
  return _assign.apply(this, arguments);
};

var SerialLoader = function (files) {
    var fileLength = files.length;
    var loadedFileLength = 0;
    var currentIndex = 0;
    // Event Emitter
    var _a = useLoaderEmitter(), progress = _a.progress, error = _a.error, complete = _a.complete, fileProgress = _a.fileProgress, fileComplete = _a.fileComplete, on = _a.on, off = _a.off, offAll = _a.offAll;
    var loaders = [];
    var fileResults = [];
    files.forEach(function (file) {
        var loader = FileLoader(file);
        loader.on({
            type: "progress",
            emitter: function (e) {
                fileProgress.emit(_assign(_assign({}, e), { file: file }));
                progress.emit({
                    total: fileLength,
                    current: loadedFileLength,
                    per: loadedFileLength / fileLength,
                });
            },
        });
        loader.on({
            type: "complete",
            emitter: function (e) {
                loadedFileLength += 1;
                fileResults.push(e.file);
                fileComplete.emit({
                    total: fileLength,
                    file: e.file,
                });
                if (loadedFileLength >= fileLength) {
                    complete.emit({
                        total: fileLength,
                        files: fileResults,
                    });
                }
                else {
                    currentIndex += 1;
                    loaders[currentIndex].start();
                }
            },
        });
        loader.on({
            type: "error",
            emitter: function (e) { return error.emit(e); },
        });
        loaders.push(loader);
    });
    return {
        on: on,
        off: off,
        offAll: offAll,
        start: function () {
            loaders[currentIndex].start();
        },
    };
};

var Loader = function (type, files) {
    switch (type) {
        case "parallel":
            return ParallelLoader(files);
        case "serial":
            return SerialLoader(files);
        default:
            var _exhaustiveCheck = type;
            return _exhaustiveCheck;
    }
};

var Backstage = function (type, files) {
    var loader = Loader(type, files);
    return loader;
};

export { Backstage };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZXMuanMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Mb2FkZXIvRXZlbnQudHMiLCIuLi8uLi9zcmMvTG9hZGVyL0ZpbGVMb2FkZXIudHMiLCIuLi8uLi9zcmMvTG9hZGVyL1BhcmFsbGVsTG9hZGVyLnRzIiwiLi4vbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIi4uLy4uL3NyYy9Mb2FkZXIvU2VyaWFsTG9hZGVyLnRzIiwiLi4vLi4vc3JjL0xvYWRlci50cyIsIi4uLy4uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldmVudG1pdCB9IGZyb20gXCJldmVudG1pdFwiO1xuaW1wb3J0IHsgRXZlbnRFbWl0VHlwZSwgRXZlbnRFbWl0S2V5IH0gZnJvbSBcIi4uL3R5cGVcIjtcblxuZXhwb3J0IGNvbnN0IHVzZUxvYWRlckVtaXR0ZXIgPSA8XG4gICAgUCA9IG51bGwsXG4gICAgRSA9IG51bGwsXG4gICAgQyA9IG51bGwsXG4gICAgRlAgPSBudWxsLFxuICAgIEZDID0gbnVsbFxuPigpID0+IHtcbiAgICBjb25zdCBwcm9ncmVzcyA9IGV2ZW50bWl0PFA+KCk7XG4gICAgY29uc3QgZXJyb3IgPSBldmVudG1pdDxFPigpO1xuICAgIGNvbnN0IGNvbXBsZXRlID0gZXZlbnRtaXQ8Qz4oKTtcbiAgICBjb25zdCBmaWxlUHJvZ3Jlc3MgPSBldmVudG1pdDxGUD4oKTtcbiAgICBjb25zdCBmaWxlQ29tcGxldGUgPSBldmVudG1pdDxGQz4oKTtcblxuICAgIGNvbnN0IG9uID0gKHsgdHlwZSwgZW1pdHRlciB9OiBFdmVudEVtaXRLZXk8UCwgRSwgQywgRlAsIEZDPikgPT4ge1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJwcm9ncmVzc1wiOlxuICAgICAgICAgICAgICAgIHByb2dyZXNzLm9uKGVtaXR0ZXIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICAgICAgICAgICAgZXJyb3Iub24oZW1pdHRlcik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY29tcGxldGVcIjpcbiAgICAgICAgICAgICAgICBjb21wbGV0ZS5vbihlbWl0dGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmaWxlX3Byb2dyZXNzXCI6XG4gICAgICAgICAgICAgICAgZmlsZVByb2dyZXNzLm9uKGVtaXR0ZXIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImZpbGVfY29tcGxldGVcIjpcbiAgICAgICAgICAgICAgICBmaWxlQ29tcGxldGUub24oZW1pdHRlcik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3Qgb2ZmID0gKHsgdHlwZSwgZW1pdHRlciB9OiBFdmVudEVtaXRLZXk8UCwgRSwgQywgRlAsIEZDPikgPT4ge1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJwcm9ncmVzc1wiOlxuICAgICAgICAgICAgICAgIHByb2dyZXNzLm9mZihlbWl0dGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICAgICAgICAgIGVycm9yLm9mZihlbWl0dGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjb21wbGV0ZVwiOlxuICAgICAgICAgICAgICAgIGNvbXBsZXRlLm9mZihlbWl0dGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmaWxlX3Byb2dyZXNzXCI6XG4gICAgICAgICAgICAgICAgZmlsZVByb2dyZXNzLm9mZihlbWl0dGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmaWxlX2NvbXBsZXRlXCI6XG4gICAgICAgICAgICAgICAgZmlsZUNvbXBsZXRlLm9mZihlbWl0dGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBvZmZBbGwgPSAoa2V5OiBFdmVudEVtaXRUeXBlKSA9PiB7XG4gICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgICBjYXNlIFwicHJvZ3Jlc3NcIjpcbiAgICAgICAgICAgICAgICBwcm9ncmVzcy5vZmZBbGwoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICAgICAgICAgIGVycm9yLm9mZkFsbCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImNvbXBsZXRlXCI6XG4gICAgICAgICAgICAgICAgY29tcGxldGUub2ZmQWxsKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZmlsZV9wcm9ncmVzc1wiOlxuICAgICAgICAgICAgICAgIGZpbGVQcm9ncmVzcy5vZmZBbGwoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmaWxlX2NvbXBsZXRlXCI6XG4gICAgICAgICAgICAgICAgZmlsZUNvbXBsZXRlLm9mZkFsbCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2dyZXNzLFxuICAgICAgICBlcnJvcixcbiAgICAgICAgY29tcGxldGUsXG4gICAgICAgIGZpbGVQcm9ncmVzcyxcbiAgICAgICAgZmlsZUNvbXBsZXRlLFxuICAgICAgICBvbixcbiAgICAgICAgb2ZmLFxuICAgICAgICBvZmZBbGwsXG4gICAgfTtcbn07XG4iLCJpbXBvcnQge1xuICAgIEZpbGVMb2FkZXJFbWl0Q29tcGxldGVUeXBlLFxuICAgIEZpbGVMb2FkZXJFbWl0RXJyb3JUeXBlLFxuICAgIEZpbGVMb2FkZXJFbWl0UHJvZ3Jlc3NUeXBlLFxufSBmcm9tIFwiLi4vdHlwZVwiO1xuaW1wb3J0IHsgdXNlTG9hZGVyRW1pdHRlciB9IGZyb20gXCIuL0V2ZW50XCI7XG5cbmV4cG9ydCBjb25zdCBGaWxlTG9hZGVyID0gKGZpbGU6IHN0cmluZykgPT4ge1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgbGV0IGN1cnJlbnQgPSAwO1xuICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgIGxldCB4aHIgPSBudWxsIGFzIFhNTEh0dHBSZXF1ZXN0IHwgbnVsbDtcblxuICAgIC8vIEV2ZW50IEVtaXR0ZXJcbiAgICBjb25zdCB7IHByb2dyZXNzLCBlcnJvciwgY29tcGxldGUsIG9uLCBvZmYsIG9mZkFsbCB9ID0gdXNlTG9hZGVyRW1pdHRlcjxcbiAgICAgICAgRmlsZUxvYWRlckVtaXRQcm9ncmVzc1R5cGUsXG4gICAgICAgIEZpbGVMb2FkZXJFbWl0RXJyb3JUeXBlLFxuICAgICAgICBGaWxlTG9hZGVyRW1pdENvbXBsZXRlVHlwZVxuICAgID4oKTtcblxuICAgIGNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xuICAgICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgeGhyLm9wZW4oXCJnZXRcIiwgZmlsZSwgdHJ1ZSk7XG4gICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSBcImJsb2JcIjtcblxuICAgICAgICB4aHIub25sb2Fkc3RhcnQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgcmVhZHkgPSB0cnVlO1xuICAgICAgICAgICAgY3VycmVudCA9IGUubG9hZGVkO1xuXG4gICAgICAgICAgICBpZiAoZS5sZW5ndGhDb21wdXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgdG90YWwgPSBlLnRvdGFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvZ3Jlc3MuZW1pdCh7IHRvdGFsLCBjdXJyZW50LCBwZXI6IGN1cnJlbnQgLyB0b3RhbCB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB4aHIub25wcm9ncmVzcyA9IChlKSA9PiB7XG4gICAgICAgICAgICBjdXJyZW50ID0gZS5sb2FkZWQ7XG5cbiAgICAgICAgICAgIGlmIChlLmxlbmd0aENvbXB1dGFibGUpIHtcbiAgICAgICAgICAgICAgICB0b3RhbCA9IGUudG90YWw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHByb2dyZXNzLmVtaXQoeyB0b3RhbCwgY3VycmVudCwgcGVyOiBjdXJyZW50IC8gdG90YWwgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgeGhyLm9ubG9hZCA9IChlKSA9PiB7XG4gICAgICAgICAgICBjb21wbGV0ZS5lbWl0KHsgdG90YWwsIGZpbGU6IHsgZmlsZSwgc2l6ZTogdG90YWwgfSB9KTtcbiAgICAgICAgICAgIGFib3J0KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgeGhyLm9uZXJyb3IgPSAoZSkgPT4ge1xuICAgICAgICAgICAgZXJyb3IuZW1pdChuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2FkICR7ZmlsZX1gKSk7XG4gICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHhoci5zZW5kKCk7XG4gICAgfTtcblxuICAgIGNvbnN0IGFib3J0ID0gKCkgPT4ge1xuICAgICAgICBpZiAoIXhocikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgeGhyLmFib3J0KCk7XG4gICAgICAgIHhociA9IG51bGw7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIG9uLFxuICAgICAgICBvZmYsXG4gICAgICAgIG9mZkFsbCxcbiAgICAgICAgc3RhcnQsXG4gICAgICAgIGFib3J0LFxuICAgIH07XG59O1xuZXhwb3J0IHR5cGUgRmlsZUxvYWRlclR5cGUgPSBSZXR1cm5UeXBlPHR5cGVvZiBGaWxlTG9hZGVyPjtcbiIsImltcG9ydCB7XG4gICAgTG9hZGVkRmlsZSxcbiAgICBQYXJhbGxlbExvYWRlckVtaXRDb21wbGV0ZVR5cGUsXG4gICAgUGFyYWxsZWxMb2FkZXJFbWl0RXJyb3JUeXBlLFxuICAgIFBhcmFsbGVsTG9hZGVyRW1pdEZpbGVDb21wbGV0ZVR5cGUsXG4gICAgUGFyYWxsZWxMb2FkZXJFbWl0UHJvZ3Jlc3NUeXBlLFxufSBmcm9tIFwiLi4vdHlwZVwiO1xuaW1wb3J0IHsgRmlsZUxvYWRlciwgRmlsZUxvYWRlclR5cGUgfSBmcm9tIFwiLi9GaWxlTG9hZGVyXCI7XG5pbXBvcnQgeyB1c2VMb2FkZXJFbWl0dGVyIH0gZnJvbSBcIi4vRXZlbnRcIjtcblxuZXhwb3J0IGNvbnN0IFBhcmFsbGVsTG9hZGVyID0gKGZpbGVzOiBzdHJpbmdbXSkgPT4ge1xuICAgIGNvbnN0IGZpbGVMZW5ndGggPSBmaWxlcy5sZW5ndGg7XG4gICAgbGV0IGxvYWRlZEZpbGVMZW5ndGggPSAwO1xuXG4gICAgLy8gRXZlbnQgRW1pdHRlclxuICAgIGNvbnN0IHsgcHJvZ3Jlc3MsIGVycm9yLCBjb21wbGV0ZSwgZmlsZUNvbXBsZXRlLCBvbiwgb2ZmLCBvZmZBbGwgfSA9XG4gICAgICAgIHVzZUxvYWRlckVtaXR0ZXI8XG4gICAgICAgICAgICBQYXJhbGxlbExvYWRlckVtaXRQcm9ncmVzc1R5cGUsXG4gICAgICAgICAgICBQYXJhbGxlbExvYWRlckVtaXRFcnJvclR5cGUsXG4gICAgICAgICAgICBQYXJhbGxlbExvYWRlckVtaXRDb21wbGV0ZVR5cGUsXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgUGFyYWxsZWxMb2FkZXJFbWl0RmlsZUNvbXBsZXRlVHlwZVxuICAgICAgICA+KCk7XG5cbiAgICBjb25zdCBsb2FkZXJzOiBGaWxlTG9hZGVyVHlwZVtdID0gW107XG4gICAgY29uc3QgZmlsZVJlc3VsdHM6IExvYWRlZEZpbGVbXSA9IFtdO1xuXG4gICAgZmlsZXMuZm9yRWFjaCgoZmlsZSkgPT4ge1xuICAgICAgICBjb25zdCBsb2FkZXIgPSBGaWxlTG9hZGVyKGZpbGUpO1xuXG4gICAgICAgIGxvYWRlci5vbih7XG4gICAgICAgICAgICB0eXBlOiBcInByb2dyZXNzXCIsXG4gICAgICAgICAgICBlbWl0dGVyOiAoXykgPT4ge1xuICAgICAgICAgICAgICAgIHByb2dyZXNzLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICB0b3RhbDogZmlsZUxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudDogbG9hZGVkRmlsZUxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgcGVyOiBsb2FkZWRGaWxlTGVuZ3RoIC8gZmlsZUxlbmd0aCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxvYWRlci5vbih7XG4gICAgICAgICAgICB0eXBlOiBcImNvbXBsZXRlXCIsXG4gICAgICAgICAgICBlbWl0dGVyOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxvYWRlZEZpbGVMZW5ndGggKz0gMTtcbiAgICAgICAgICAgICAgICBmaWxlUmVzdWx0cy5wdXNoKGUuZmlsZSk7XG5cbiAgICAgICAgICAgICAgICBmaWxlQ29tcGxldGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiBmaWxlTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBmaWxlOiBlLmZpbGUsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAobG9hZGVkRmlsZUxlbmd0aCA+PSBmaWxlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IGZpbGVMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlczogZmlsZVJlc3VsdHMsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxvYWRlci5vbih7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBlbWl0dGVyOiAoZSkgPT4gZXJyb3IuZW1pdChlKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbG9hZGVycy5wdXNoKGxvYWRlcik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBvbixcbiAgICAgICAgb2ZmLFxuICAgICAgICBvZmZBbGwsXG4gICAgICAgIHN0YXJ0OiAoKSA9PiB7XG4gICAgICAgICAgICBsb2FkZXJzLmZvckVhY2goKGxvYWRlcikgPT4gbG9hZGVyLnN0YXJ0KCkpO1xuICAgICAgICB9LFxuICAgIH07XG59O1xuIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY3JlYXRlQmluZGluZyhvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgcHJpdmF0ZU1hcCkge1xyXG4gICAgaWYgKCFwcml2YXRlTWFwLmhhcyhyZWNlaXZlcikpIHtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIGdldCBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBwcml2YXRlTWFwLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBwcml2YXRlTWFwLCB2YWx1ZSkge1xyXG4gICAgaWYgKCFwcml2YXRlTWFwLmhhcyhyZWNlaXZlcikpIHtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIHNldCBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcclxuICAgIH1cclxuICAgIHByaXZhdGVNYXAuc2V0KHJlY2VpdmVyLCB2YWx1ZSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuIiwiaW1wb3J0IHtcbiAgICBMb2FkZWRGaWxlLFxuICAgIFNlcmlhbExvYWRlckVtaXRDb21wbGV0ZVR5cGUsXG4gICAgU2VyaWFsTG9hZGVyRW1pdEVycm9yVHlwZSxcbiAgICBTZXJpYWxMb2FkZXJFbWl0RmlsZUNvbXBsZXRlVHlwZSxcbiAgICBTZXJpYWxMb2FkZXJFbWl0RmlsZVByb2dyZXNzVHlwZSxcbiAgICBTZXJpYWxMb2FkZXJFbWl0UHJvZ3Jlc3NUeXBlLFxufSBmcm9tIFwiLi4vdHlwZVwiO1xuaW1wb3J0IHsgRmlsZUxvYWRlciwgRmlsZUxvYWRlclR5cGUgfSBmcm9tIFwiLi9GaWxlTG9hZGVyXCI7XG5pbXBvcnQgeyB1c2VMb2FkZXJFbWl0dGVyIH0gZnJvbSBcIi4vRXZlbnRcIjtcblxuZXhwb3J0IGNvbnN0IFNlcmlhbExvYWRlciA9IChmaWxlczogc3RyaW5nW10pID0+IHtcbiAgICBjb25zdCBmaWxlTGVuZ3RoID0gZmlsZXMubGVuZ3RoO1xuICAgIGxldCBsb2FkZWRGaWxlTGVuZ3RoID0gMDtcbiAgICBsZXQgY3VycmVudEluZGV4ID0gMDtcblxuICAgIC8vIEV2ZW50IEVtaXR0ZXJcbiAgICBjb25zdCB7XG4gICAgICAgIHByb2dyZXNzLFxuICAgICAgICBlcnJvcixcbiAgICAgICAgY29tcGxldGUsXG4gICAgICAgIGZpbGVQcm9ncmVzcyxcbiAgICAgICAgZmlsZUNvbXBsZXRlLFxuICAgICAgICBvbixcbiAgICAgICAgb2ZmLFxuICAgICAgICBvZmZBbGwsXG4gICAgfSA9IHVzZUxvYWRlckVtaXR0ZXI8XG4gICAgICAgIFNlcmlhbExvYWRlckVtaXRQcm9ncmVzc1R5cGUsXG4gICAgICAgIFNlcmlhbExvYWRlckVtaXRFcnJvclR5cGUsXG4gICAgICAgIFNlcmlhbExvYWRlckVtaXRDb21wbGV0ZVR5cGUsXG4gICAgICAgIFNlcmlhbExvYWRlckVtaXRGaWxlUHJvZ3Jlc3NUeXBlLFxuICAgICAgICBTZXJpYWxMb2FkZXJFbWl0RmlsZUNvbXBsZXRlVHlwZVxuICAgID4oKTtcblxuICAgIGNvbnN0IGxvYWRlcnM6IEZpbGVMb2FkZXJUeXBlW10gPSBbXTtcbiAgICBjb25zdCBmaWxlUmVzdWx0czogTG9hZGVkRmlsZVtdID0gW107XG5cbiAgICBmaWxlcy5mb3JFYWNoKChmaWxlKSA9PiB7XG4gICAgICAgIGNvbnN0IGxvYWRlciA9IEZpbGVMb2FkZXIoZmlsZSk7XG5cbiAgICAgICAgbG9hZGVyLm9uKHtcbiAgICAgICAgICAgIHR5cGU6IFwicHJvZ3Jlc3NcIixcbiAgICAgICAgICAgIGVtaXR0ZXI6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZmlsZVByb2dyZXNzLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAuLi5lLFxuICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3MuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiBmaWxlTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50OiBsb2FkZWRGaWxlTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBwZXI6IGxvYWRlZEZpbGVMZW5ndGggLyBmaWxlTGVuZ3RoLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbG9hZGVyLm9uKHtcbiAgICAgICAgICAgIHR5cGU6IFwiY29tcGxldGVcIixcbiAgICAgICAgICAgIGVtaXR0ZXI6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgbG9hZGVkRmlsZUxlbmd0aCArPSAxO1xuICAgICAgICAgICAgICAgIGZpbGVSZXN1bHRzLnB1c2goZS5maWxlKTtcblxuICAgICAgICAgICAgICAgIGZpbGVDb21wbGV0ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWw6IGZpbGVMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIGZpbGU6IGUuZmlsZSxcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChsb2FkZWRGaWxlTGVuZ3RoID49IGZpbGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZmlsZUxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzOiBmaWxlUmVzdWx0cyxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEluZGV4ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRlcnNbY3VycmVudEluZGV4XS5zdGFydCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxvYWRlci5vbih7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBlbWl0dGVyOiAoZSkgPT4gZXJyb3IuZW1pdChlKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbG9hZGVycy5wdXNoKGxvYWRlcik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBvbixcbiAgICAgICAgb2ZmLFxuICAgICAgICBvZmZBbGwsXG4gICAgICAgIHN0YXJ0OiAoKSA9PiB7XG4gICAgICAgICAgICBsb2FkZXJzW2N1cnJlbnRJbmRleF0uc3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICB9O1xufTtcbiIsImltcG9ydCB7IExvYWRlclR5cGUgfSBmcm9tIFwiLi90eXBlXCI7XG5pbXBvcnQgeyBQYXJhbGxlbExvYWRlciB9IGZyb20gXCIuL0xvYWRlci9QYXJhbGxlbExvYWRlclwiO1xuaW1wb3J0IHsgU2VyaWFsTG9hZGVyIH0gZnJvbSBcIi4vTG9hZGVyL1NlcmlhbExvYWRlclwiO1xuXG5leHBvcnQgY29uc3QgTG9hZGVyID0gKHR5cGU6IExvYWRlclR5cGUsIGZpbGVzOiBzdHJpbmdbXSkgPT4ge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIFwicGFyYWxsZWxcIjpcbiAgICAgICAgICAgIHJldHVybiBQYXJhbGxlbExvYWRlcihmaWxlcyk7XG4gICAgICAgIGNhc2UgXCJzZXJpYWxcIjpcbiAgICAgICAgICAgIHJldHVybiBTZXJpYWxMb2FkZXIoZmlsZXMpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY29uc3QgX2V4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSB0eXBlO1xuICAgICAgICAgICAgcmV0dXJuIF9leGhhdXN0aXZlQ2hlY2s7XG4gICAgfVxufTtcbiIsImltcG9ydCB7IExvYWRlciB9IGZyb20gXCIuL0xvYWRlclwiO1xuaW1wb3J0IHsgTG9hZGVyVHlwZSB9IGZyb20gXCIuL3R5cGVcIjtcblxuZXhwb3J0IGNvbnN0IEJhY2tzdGFnZSA9ICh0eXBlOiBMb2FkZXJUeXBlLCBmaWxlczogc3RyaW5nW10pID0+IHtcbiAgICBjb25zdCBsb2FkZXIgPSBMb2FkZXIodHlwZSwgZmlsZXMpO1xuICAgIHJldHVybiBsb2FkZXI7XG59O1xuIl0sIm5hbWVzIjpbIl9fYXNzaWduIiwiT2JqZWN0IiwiYXNzaWduIiwidCIsInMiLCJpIiwibiIsImFyZ3VtZW50cyIsImxlbmd0aCIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJhcHBseSJd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QUk7QUFDZixpQkFBQSxDQUFDLENBQUM7Z0JBRUgsSUFBSSxnQkFBZ0IsSUFBSSxVQUFVLEVBQUU7b0JBQ2hDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFDVix3QkFBQSxLQUFLLEVBQUUsVUFBVTtBQUNqQix3QkFBQSxLQUFLLEVBQUUsV0FBVztBQUNyQixxQkFBQSxDQUFDLENBQUM7QUFDTixpQkFBQTtBQUFNLHFCQUFBO29CQUNILFlBQVksSUFBSSxDQUFDLENBQUM7QUFDbEIsb0JBQUEsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQ2pDLGlCQUFBO2FBQ0o7QUFDSixTQUFBLENBQUMsQ0FBQztRQUVILE1BQU0sQ0FBQyxFQUFFLENBQUM7QUFDTixZQUFBLElBQUksRUFBRSxPQUFPO0FBQ2IsWUFBQSxPQUFPLEVBQUUsVUFBQyxDQUFDLEVBQUEsRUFBSyxPQUFBLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUEsRUFBQTtBQUNoQyxTQUFBLENBQUMsQ0FBQztBQUVILFFBQUEsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN6QixLQUFDLENBQUMsQ0FBQztJQUVILE9BQU87QUFDSCxRQUFBLEVBQUUsRUFBQSxFQUFBO0FBQ0YsUUFBQSxHQUFHLEVBQUEsR0FBQTtBQUNILFFBQUEsTUFBTSxFQUFBLE1BQUE7QUFDTixRQUFBLEtBQUssRUFBRSxZQUFBO0FBQ0gsWUFBQSxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7U0FDakM7S0FDSixDQUFDO0FBQ04sQ0FBQzs7QUMzRk0sSUFBTSxNQUFNLEdBQUcsVUFBQyxJQUFnQixFQUFFLEtBQWUsRUFBQTtBQUNwRCxJQUFBLFFBQVEsSUFBSTtBQUNSLFFBQUEsS0FBSyxVQUFVO0FBQ1gsWUFBQSxPQUFPLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNqQyxRQUFBLEtBQUssUUFBUTtBQUNULFlBQUEsT0FBTyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDL0IsUUFBQTtZQUNJLElBQU0sZ0JBQWdCLEdBQVUsSUFBSSxDQUFDO0FBQ3JDLFlBQUEsT0FBTyxnQkFBZ0IsQ0FBQztBQUMvQixLQUFBO0FBQ0wsQ0FBQzs7QUNYWSxJQUFBLFNBQVMsR0FBRyxVQUFDLElBQWdCLEVBQUUsS0FBZSxFQUFBO0lBQ3ZELElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDbkMsSUFBQSxPQUFPLE1BQU0sQ0FBQztBQUNsQjs7OzsiLCJ4X2dvb2dsZV9pZ25vcmVMaXN0IjpbM119
