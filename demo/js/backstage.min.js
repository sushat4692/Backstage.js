/*!
  backstage.js v0.0.1
  https://github.com/sushat4692/backstage.js#readme
  Released under the MIT License.
*/
var Backstage=function(){"use strict";var e=function(){var e=new Set;return{on:function(r){e.add(r)},off:function(r){e.delete(r)},offAll:function(){e.clear()},emit:function(r){e.forEach((function(e){return e(r)}))}}},r=function(e,r){var t=e.length,n=[],o=e.map((function(e){return{file:e,size:0}}));return e.forEach((function(e){var f=function(e,r,t,n){var o=0,f=0,c=!1;return{start:function(){var a=new XMLHttpRequest;a.open("get",e,!0),a.responseType="blob",a.onprogress=function(e){e.lengthComputable&&(c=!0,o=e.total,f=e.loaded,r())},a.onload=function(r){t(e,o)},a.onerror=function(e){n()},a.send()},total:function(){return o},current:function(){return f},ready:function(){return c}}}(e,(function(){var e=!0,t=n.reduce((function(r,t){return r.total+=t.total(),r.current+=t.current(),e=e&&t.ready(),r}),{total:0,current:0,per:0});e&&(t.per=t.current/t.total,r("progress",t))}),(function(e,n){r("file_complete",{file:e,size:n});var f=0;o=o.map((function(r){var t=e===r.file?n:r.size;return f+=t,{file:r.file,size:t}})),(t-=1)<=0&&r("complete",{total:f,files:o})}),(function(){r("error",new Error("error"))}));n.push(f)})),{start:function(){n.forEach((function(e){e.start()}))}}};return function(t){var n,o,f,c,a=(n=e(),o=e(),f=e(),c=e(),{on:function(e,r){switch(e){case"progress":n.on(r);break;case"error":o.on(r);break;case"file_complete":f.on(r);break;case"complete":c.on(r)}},off:function(e,r){switch(e){case"progress":n.off(r);break;case"error":o.off(r);break;case"file_complete":f.off(r);break;case"complete":c.off(r)}},offAll:function(e){switch(e){case"progress":n.offAll();break;case"error":o.offAll();break;case"file_complete":f.offAll();break;case"complete":c.offAll()}},emit:function(e,r){switch(e){case"progress":return n.emit(r);case"error":return o.emit(r);case"file_complete":return f.emit(r);case"complete":return c.emit(r)}}});return{on:a.on,off:a.off,offAll:a.offAll,start:r(t,a.emit).start}}}();
